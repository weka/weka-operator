apiVersion: weka.weka.io/v1alpha1
kind: WekaCluster
metadata:
  name: cluster-dev
  namespace: default
spec:
  template: dynamic
  dynamicTemplate:
      computeContainers: 6
      driveContainers: 6
      nfsGatewayContainers: 2
  imagePullSecret: "quay-io-robot-secret"
  image: quay.io/weka.io/weka-in-container:4.4.1.8763-14fac292b856304e7f04e8804474b09c-dev
  driversDistService: "https://weka-driver-builder.weka-operator-system.svc.cluster.local:60002"
  gracefulDestroyDuration: 0s
---
apiVersion: weka.weka.io/v1alpha1
kind: WekaContainer
metadata:
  name: weka-driver-builder
  namespace: weka-operator-system
  labels:
    app: weka-driver-builder
spec:
  agentPort: 60001
  image: quay.io/weka.io/weka-in-container:4.4.1.8763-14fac292b856304e7f04e8804474b09c-dev
  imagePullSecret: "quay-io-robot-secret"
  mode: "dist"
  name: dist
  numCores: 1
  port: 60002

---
apiVersion: v1
kind: Service
metadata:
  name: weka-driver-builder
  namespace: weka-operator-system
spec:
  type: ClusterIP
  ports:
    - name: weka-driver-builder
      port: 60002
      targetPort: 60002
  selector:
    app: weka-driver-builder
---

apiVersion: weka.weka.io/v1alpha1
kind: WekaPolicy
metadata:
  name: sign-aws-drives-policy
  namespace: weka-operator-system
spec:
  type: "sign-drives"
  image: quay.io/weka.io/weka-in-container:4.4.1.8763-14fac292b856304e7f04e8804474b09c-dev
  imagePullSecret: "quay-io-robot-secret"
  payload:
    signDrivesPayload:
      type: aws-all
      nodeSelector:
        weka.io/supports-backends: "true"
    interval: 10m

---
apiVersion: weka.weka.io/v1alpha1
kind: WekaPolicy
metadata:
  name: discover-drives-policy
  namespace: weka-operator-system
spec:
  type: "discover-drives"
  image: quay.io/weka.io/weka-in-container:4.4.1.8763-14fac292b856304e7f04e8804474b09c-dev
  imagePullSecret: "quay-io-robot-secret"
  payload:
    discoverDrivesPayload:
      nodeSelector:
        weka.io/supports-backends: "true"
    interval: 10m
