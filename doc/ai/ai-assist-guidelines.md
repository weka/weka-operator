# AI Assistance Guidelines

## Overview
This document provides guidance for AI assistants when helping users with the Weka Operator. It outlines critical steps, best practices, and common scenarios to ensure accurate and effective assistance.

## Critical Guidelines
- Pay high significance to steps marked with `AIMUST` tag
- When provisioning clusters, if the number of drives is not specified explicitly, use 2 as the default

## Environment Determination
- When asked to provision a cluster, if it's unclear whether the test runs on a physical environment or in cloud, clarify with the user
- Physical environments must specify a network section, either by subnet or by devices

## Cluster Provisioning Rules
- Always provision a WekaCluster with a test-autogenerated name
  - Autogenerated part of name should not be longer than 16 characters
  - Autogenerated name should start with `test-`
  - Names should conform with Kubernetes resource naming conventions (32 characters max)
- Generate fully built YAML that will be applied AS IS
- Always generate yaml in one step and apply it in another step AIMUST
- Make sure to preserve all field on WekaCluster and WekaClient as in example, adding optional as needed AIMUST
- Pay attention that WekaCluster uses apiVersion: `weka.weka.io/v1alpha1`
- When the image parameter doesn't specify a repository, use `quay.io/weka.io/weka-in-container:`

## Command Execution
- Weka CLI commands to get cluster status should be executed within compute or drive containers
- For weka cli commands execution via exec - never select a WekaContainer or pod without filtering by specific cluster name (`weka.io/cluster-name=wekacluster.metadata.name`) or by specific container name

## Cluster Configuration
- If instructions contain wording such as "configure", "set", or "update" some parameter, adjust the initial YAML to such requests
- Explicit update requests will be stated as updates in the broader context of the task
- Apply Kubernetes resource YAMLs using `kubectl apply -f file.yaml` or other method that works against Kubernetes API

## Error Handling
- Be eager to retry and rebuild step requests if they fail before fully failing test execution
- When testing with `gracefulDestroyDuration` not set to 0s, do not use blocking kubectl delete as it will take hours to finish
- Avoid long polling periods (e.g., 10 minutes); instead, use shorter polling intervals (e.g., 1 minute) for more dynamic error handling

# Common 
- imagePullSecret when needed - use `quay-io-robot-secret` as default, this is rarely changed